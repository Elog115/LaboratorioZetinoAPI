@{
    ViewData["Title"] = "Dashboard";
}

<div class="row">
    <div class="col">
        <h1 class="h3 mb-1" style="color: #0b5e6f;">Panel de Control</h1>
        <p class="mb-4 text-muted">Resumen general del sistema y accesos directos.</p>
    </div>
</div>

<!-- =============================== -->
<!--          TARJETAS SUPERIORES    -->
<!-- =============================== -->

<div class="row">
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-primary shadow-sm h-100 py-2 rounded-3">
            <div class="card-body position-relative">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs fw-bold text-primary text-uppercase mb-1">Citas del día</div>
                        <div class="h5 mb-0 fw-bold">@ViewBag.CitasDia</div>
                    </div>
                    <div class="col-auto">
                        <i class="bi bi-calendar2-check fs-3 text-primary"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow-sm h-100 py-2 rounded-3">
            <div class="card-body position-relative">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs fw-bold text-success text-uppercase mb-1">Pacientes atendidos</div>
                        <div class="h5 mb-0 fw-bold">@ViewBag.PacientesAtendidos</div>
                    </div>
                    <div class="col-auto">
                        <i class="bi bi-person-check fs-3 text-success"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow-sm h-100 py-2 rounded-3">
            <div class="card-body position-relative">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs fw-bold text-warning text-uppercase mb-1">Resultados pendientes</div>
                        <div class="h5 mb-0 fw-bold">@ViewBag.ResultadosPendientes</div>
                    </div>
                    <div class="col-auto">
                        <i class="bi bi-file-earmark-text fs-3 text-warning"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-danger shadow-sm h-100 py-2 rounded-3">
            <div class="card-body position-relative">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs fw-bold text-danger text-uppercase mb-1">Pagos pendientes</div>
                        <div class="h5 mb-0 fw-bold">@ViewBag.PagosPendientes</div>
                    </div>
                    <div class="col-auto">
                        <i class="bi bi-cash-coin fs-3 text-danger"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- =============================== -->
<!--       RESUMEN DE ACTIVIDADES     -->
<!-- =============================== -->

<h4 class="mb-3 fw-bold" style="color: #0b5e6f;">Resumen de actividades</h4>

<div class="row">
    <!-- GRÁFICO: CITAS POR SEMANA -->
    <div class="col-xl-6 col-md-12 mb-4">
        <div class="card shadow-sm rounded-3 p-3">
            <h6 class="fw-bold mb-2">Citas por semana</h6>
            <canvas id="citasSemanaChart" height="140"></canvas>
        </div>
    </div>

    <!-- OTRO GRÁFICO (PUEDES REEMPLAZARLO LUEGO) -->
    <div class="col-xl-6 col-md-12 mb-4">
        <div class="card shadow-sm rounded-3 p-3">
            <h6 class="fw-bold mb-2">Ingresos mensuales</h6>
            <canvas id="ingresosChart" height="140"></canvas>
        </div>
    </div>
</div>

<!-- =============================== -->
<!--   SCRIPTS DE GRÁFICOS CHART.JS   -->
<!-- =============================== -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // 🔹 Datos de ejemplo (luego te lo pongo dinámico con tu API)
    const citasPorSemana = [12, 18, 15, 20, 17, 22];

    const ctxSemana = document.getElementById('citasSemanaChart').getContext('2d');

    new Chart(ctxSemana, {
        type: 'line',
        data: {
            labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4', 'Semana 5', 'Semana 6'],
            datasets: [{
                label: 'Citas',
                data: citasPorSemana,
                tension: 0.4,
                borderWidth: 3,
                pointRadius: 5,
                fill: true,
                borderColor: '#0d6efd',
                backgroundColor: 'rgba(13,110,253,0.15)',
                pointBackgroundColor: '#0d6efd',
                pointBorderColor: '#fff'
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>

<script>
    // 🔹 Gráfico placeholder para ingresos (puedes cambiarlo)
    const ctxIngresos = document.getElementById('ingresosChart').getContext('2d');
    new Chart(ctxIngresos, {
        type: 'bar',
        data: {
            labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
            datasets: [{
                label: 'Ingresos',
                data: [2500, 2700, 2600, 3000, 2800, 3100],
                backgroundColor: 'rgba(13,110,253,0.4)',
                borderColor: '#0d6efd',
                borderWidth: 2
            }]
        }
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Llamar los datos del controlador
    fetch('/Cita/GetCitasPorSemana')
        .then(response => response.json())
        .then(data => {
            const ctxSemana = document.getElementById('citasSemanaChart').getContext('2d');

            new Chart(ctxSemana, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Citas por semana',
                        data: data.valores,
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 5,
                        fill: true,
                        borderColor: '#0d6efd',
                        backgroundColor: 'rgba(13,110,253,0.15)',
                        pointBackgroundColor: '#0d6efd',
                        pointBorderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        })
        .catch(error => console.error('Error cargando citas por semana:', error));
</script>


